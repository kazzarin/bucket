{
    "version": "3.3.1",
    "description": "Collection of shell extensions that provide File Explorer thumbnails for a variety of video formats.",
    "homepage": "https://github.com/Xanashi/Icaros",
    "license": "Freeware",
    "url": "https://github.com/Xanashi/Icaros/releases/download/v3.3.1/Icaros_v3.3.1.zip",
    "hash": "920a342dec0b6565749671b42e068d8a317b83c8258ae57efe63fec332769579",
    "pre_install": [
        "if (!(is_admin)) {",
        "    error \"Administrator rights are required to install $app.\"",
        "    break",
        "}"
    ],
    "post_install": [
        "regsvr32 /s \"$dir\\32-bit\\IcarosThumbnailProvider.dll\"",
        "regsvr32 /s \"$dir\\32-bit\\IcarosPropertyHandler.dll\"",
        "",
        "if ($architecture -eq '64bit') {",
        "    regsvr32 /s \"$dir\\64-bit\\IcarosThumbnailProvider.dll\"",
        "    regsvr32 /s \"$dir\\64-bit\\IcarosPropertyHandler.dll\"",
        "}",
        "",
        "Stop-Process -Name explorer"
    ],
    "uninstaller": {
        "script": [
            "if (!(is_admin)) {",
            "    error \"Administrator rights are required to uninstall $app.\"",
            "    break",
            "}",
            "",
            "regsvr32 /s /u \"$dir\\32-bit\\IcarosThumbnailProvider.dll\"",
            "regsvr32 /s /u \"$dir\\32-bit\\IcarosPropertyHandler.dll\"",
            "",
            "if ($architecture -eq '64bit') {",
            "    regsvr32 /s /u \"$dir\\64-bit\\IcarosThumbnailProvider.dll\"",
            "    regsvr32 /s /u \"$dir\\64-bit\\IcarosPropertyHandler.dll\"",
            "}",
            "",
            "Stop-Process -Name explorer",
            "# This seems to impede uninstallation sometimes",
            "Stop-Process -ErrorAction Ignore -Name OpenWith"
        ]
    },
    "bin": "IcarosConfig.exe",
    "shortcuts": [
        [
            "IcarosConfig.exe",
            "Icaros"
        ]
    ],
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/Xanashi/Icaros/releases/download/v$version/Icaros_v$version.zip"
    }
}
